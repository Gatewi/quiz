Dá»±a trÃªn cÃ¡c yÃªu cáº§u chi tiáº¿t báº¡n Ä‘Ã£ cung cáº¥p, tÃ´i Ä‘Ã£ há»‡ thá»‘ng láº¡i tÃ i liá»‡u **User Flow cho PettyQuiz**. Báº£n thiáº¿t káº¿ nÃ y táº­p trung vÃ o tÃ­nh logic cháº·t cháº½, cÃ¡c tráº¡ng thÃ¡i dá»¯ liá»‡u (data states) vÃ  cÆ¡ cháº¿ tá»± Ä‘á»™ng hÃ³a Ä‘á»ƒ AI cÃ³ thá»ƒ dá»… dÃ ng chuyá»ƒn Ä‘á»•i thÃ nh cáº¥u trÃºc Database vÃ  logic láº­p trÃ¬nh.
---
## ğŸŸ¦ Há»† THá»NG USER FLOW: PETTYQUIZ APP
TÃ i liá»‡u nÃ y mÃ´ táº£ hÃ nh trÃ¬nh ngÆ°á»i dÃ¹ng xuyÃªn suá»‘t tá»« khi báº¯t Ä‘áº§u Ä‘áº¿n khi káº¿t thÃºc, bao gá»“m cáº£ cÃ¡c cÆ¡ cháº¿ xá»­ lÃ½ dá»¯ liá»‡u ngáº§m.

### 1. Luá»“ng XÃ¡c thá»±c & Quáº£n trá»‹ tÃ i khoáº£n (Auth & Account Flow)
Luá»“ng nÃ y Ä‘áº£m báº£o tÃ­nh báº£o máº­t vÃ  tráº¡ng thÃ¡i hoáº¡t Ä‘á»™ng cá»§a ngÆ°á»i dÃ¹ng.
* **Truy cáº­p:** Giao diá»‡n máº·c Ä‘á»‹nh lÃ  **Dark Mode**.
* **ÄÄƒng kÃ½:** NgÆ°á»i dÃ¹ng Ä‘Äƒng kÃ½ má»›i -> Há»‡ thá»‘ng gá»­i URL kÃ­ch hoáº¡t tá»± Ä‘á»™ng.
* **ÄÄƒng nháº­p:** * Há»— trá»£ Email/Password hoáº·c **Login with Google**.
* **Kiá»ƒm tra Ä‘iá»u kiá»‡n:** Chá»‰ tÃ i khoáº£n Ä‘Ã£ active vÃ  khÃ´ng bá»‹ Admin khÃ³a má»›i cÃ³ thá»ƒ Ä‘Äƒng nháº­p.
* **KhÃ´i phá»¥c:** Luá»“ng QuÃªn máº­t kháº©u -> Nháº­n Email -> Táº¡o láº¡i máº­t kháº©u má»›i.

### 2. Luá»“ng Thiáº¿t láº­p & Tiáº¿p tá»¥c (Home & Resume Flow)
Giai Ä‘oáº¡n khá»Ÿi táº¡o hoáº·c khÃ´i phá»¥c má»™t phiÃªn lÃ m bÃ i.
* **KhÃ´i phá»¥c phiÃªn (Resume):** Náº¿u cÃ³ bÃ i thi Ä‘ang lÃ m dá»Ÿ (`In_Progress`) vÃ  chÆ°a quÃ¡ 7 ngÃ y, há»‡ thá»‘ng hiá»ƒn thá»‹ má»¥c "Báº¡n cÃ³ bÃ i thi chÆ°a hoÃ n thÃ nh".
* **Tiáº¿p tá»¥c:** Táº£i láº¡i cÃ¢u há»i táº¡i vá»‹ trÃ­ `LastQuestionIndex`, thá»i gian `TimeElapsed` vÃ  sá»‘ lÆ°á»£t gá»£i Ã½ cÃ²n láº¡i.
**LÃ m bÃ i má»›i:** NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ bá» qua bÃ i cÅ© Ä‘á»ƒ táº¡o bÃ i thi má»›i.

* **Thiáº¿t láº­p má»›i:**
1. Chá»n **Lá»›p há»c** & **MÃ´n há»c** (Dropdown cÃ³ thanh trÆ°á»£t).
2. Há»‡ thá»‘ng lá»c danh sÃ¡ch **BÃ i há»c** (Lessons) tÆ°Æ¡ng á»©ng.
3. Chá»n **Sá»‘ lÆ°á»£ng cÃ¢u há»i** (30, 50, 70, 100).
**Pháº£n há»“i Real-time:** Hiá»ƒn thá»‹ thÃ´ng tin tá»•ng há»£p (MÃ´n, Sá»‘ bÃ i, Sá»‘ cÃ¢u, Thá»i gian dá»± kiáº¿n) dá»±a trÃªn cÃ¡c lá»±a chá»n.

### 3. Luá»“ng LÃ m bÃ i thi & Tá»± Ä‘á»™ng lÆ°u (Quiz & Auto-save Flow)
Äáº£m báº£o tráº£i nghiá»‡m liÃªn tá»¥c vÃ  khÃ´ng máº¥t dá»¯ liá»‡u.
* **HÃ nh Ä‘á»™ng:** NgÆ°á»i dÃ¹ng chá»n Ä‘Ã¡p Ã¡n (1 trong 4).
* **CÆ¡ cháº¿ Auto-save:** Má»—i khi chá»n Ä‘Ã¡p Ã¡n hoáº·c nháº¥n "Tiáº¿p theo", há»‡ thá»‘ng tá»± Ä‘á»™ng cáº­p nháº­t báº£n ghi nhÃ¡p vÃ o báº£ng `PendingQuizzes`.
* **Sá»­ dá»¥ng Gá»£i Ã½:** * Quy táº¯c: Cá»© 10 cÃ¢u há»i trong bÃ i kiá»ƒm tra thÃ¬ ngÆ°á»i dÃ¹ng sáº½ cÃ³ 1 lÆ°á»£t hint (vÃ­ dá»¥: 50 cÃ¢u -> 5 lÆ°á»£t).
* Náº¿u lÆ°á»£t gá»£i Ã½ > 0: Hiá»‡n Pop-up gá»£i Ã½ vÃ  trá»« lÆ°á»£t.
* Náº¿u lÆ°á»£t gá»£i Ã½ = 0: NÃºt gá»£i Ã½ bá»‹ vÃ´ hiá»‡u hÃ³a (Disabled).
* **Äiá»u hÆ°á»›ng:** CÃ³ thá»ƒ di chuyá»ƒn "Tiáº¿p theo" hoáº·c "Quay láº¡i" giá»¯a cÃ¡c cÃ¢u há»i. CÃ¢u cuá»‘i cÃ¹ng sáº½ xuáº¥t hiá»‡n nÃºt **"HoÃ n thÃ nh"**.
### 4. Luá»“ng Káº¿t quáº£ & PhÃ¢n tÃ­ch (Result & Reporting Flow)
Chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u tá»« tráº¡ng thÃ¡i "LÃ m bÃ i" sang "HoÃ n thÃ nh".
* **Xá»­ lÃ½:** Nháº¥n "HoÃ n thÃ nh" -> LÆ°u káº¿t quáº£ cuá»‘i cÃ¹ng -> ÄÃ¡nh dáº¥u phiÃªn lÃ m bÃ i lÃ  `Completed`.
* **Xem láº¡i:** Hiá»ƒn thá»‹ tá»· lá»‡ Ä‘Ãºng/sai, lá»i giáº£i chi tiáº¿t vÃ  danh sÃ¡ch cÃ¢u sai.
* **BÃ¡o cÃ¡o tá»•ng há»£p:** * Lá»c theo thá»i gian (máº·c Ä‘á»‹nh 7 ngÃ y).
* Biá»ƒu Ä‘á»“ thanh ngang sáº¯p xáº¿p theo hiá»‡u suáº¥t mÃ´n há»c (cao xuá»‘ng tháº¥p).
* Lá»‹ch sá»­ chi tiáº¿t: Cho phÃ©p sáº¯p xáº¿p vÃ  xem láº¡i lá»—i sai cá»§a tá»«ng bÃ i cÅ©.
---
## âš™ï¸ CÆ  CHáº¾ Dá»® LIá»†U Há»† THá»NG (SYSTEM LOGIC)
Äá»ƒ há»— trá»£ User Flow trÃªn, Database vÃ  Server cáº§n tuÃ¢n thá»§ cÃ¡c quy táº¯c sau:
### Quáº£n lÃ½ tráº¡ng thÃ¡i phiÃªn (Quiz Sessions)
* **Báº£ng `QuizSessions`:** LÆ°u trá»¯ toÃ n bá»™ tráº¡ng thÃ¡i "Ä‘ang lÃ m dá»Ÿ" bao gá»“m: `LastQuestionIndex`, `TimeElapsed`, `RemainingHints`, vÃ  `ExpirationDate`.
* **Tráº¡ng thÃ¡i `is_completed`:** DÃ¹ng Ä‘á»ƒ lá»c bÃ i thi Ä‘Ã£ ná»™p vÃ  bÃ i thi nhÃ¡p.
### CÆ¡ cháº¿ Tá»± Ä‘á»™ng dá»n dáº¹p (Cleanup Logic)
Há»‡ thá»‘ng sá»­ dá»¥ng **Cron Job** cháº¡y hÃ ng ngÃ y Ä‘á»ƒ quáº£n lÃ½ tÃ i nguyÃªn.
1. **QuÃ©t:** TÃ¬m cÃ¡c phiÃªn cÃ³ `Status = In_Progress`.
2. **Kiá»ƒm tra:** Náº¿u `CurrentDate > ExpirationDate` (sau 7 ngÃ y ká»ƒ tá»« lÃºc táº¡o).
3. **Xá»­ lÃ½:** Chuyá»ƒn tráº¡ng thÃ¡i sang `Expired` hoáº·c xÃ³a cá»©ng khá»i há»‡ thá»‘ng Ä‘á»ƒ Ä‘áº£m báº£o database gá»n nháº¹.
---
